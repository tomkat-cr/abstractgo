# Dockerfile for Python, Node.js, Torch, Safetensors, Litellm, FastAPI, and FastMCP build
# 2025-08-28 | CR

# Use an official Python runtime as a parent image
FROM python:3.12-slim

ENV NODE_VERSION=20

# Set the working directory in the container
WORKDIR /code

# Update apt and install curl
RUN apt-get update && apt-get install -y curl

# Install Node.js
RUN curl -fsSL https://deb.nodesource.com/setup_${NODE_VERSION}.x | bash -
RUN apt-get install -y nodejs

# Install MCP Inspector
RUN npm install -g @modelcontextprotocol/inspector

# Upgrade pip
RUN pip install --upgrade pip

# Install Python dependencies
RUN pip install --no-cache-dir --upgrade \
    "fastapi>=0.116.1,<0.117.0" \
    "transformers>=4.55.3,<5.0.0" \
    "uvicorn>=0.35.0,<0.36.0" \
    "python-multipart>=0.0.20,<0.0.21" \
    "torch>=2.8.0,<3.0.0" \
    "litellm>=1.75.9,<2.0.0" \
    "safetensors>=0.6.2,<0.7.0" \
    "peft>=0.17.1,<0.18.0" \
    "fastmcp>=2.11.3,<3.0.0"

